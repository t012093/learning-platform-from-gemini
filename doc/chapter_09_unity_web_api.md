# 第9章｜Unity × Web × API（実践）

## 9-1. UnityからAPIを叩く

### HTTP通信 (UnityWebRequest)
*   Webブラウザと同じように、Unityからサーバーにデータを送ったりもらったりできます。
*   `UnityWebRequest.Get(url)` や `.Post(url, data)` を使います。
*   AIに「UnityWebRequestを使って、このURLからデータを取得するコルーチンを書いて」と頼めば、定型文を書いてくれます。

### JSON処理
*   サーバーとの会話は基本的にテキストデータ（JSON形式）で行います。
*   `JsonUtility` というUnity標準機能を使って、C#のクラスとJSONテキストを相互変換（シリアライズ/デシリアライズ）します。

### 非同期の考え方 (Async/Await, Coroutine)
*   通信は「待ち時間」が発生します。待っている間もゲーム（Updateループ）を止めないために、「非同期処理」が必要です。
*   C#の `async/await` は強力ですが、Unity独自のライフサイクルとの兼ね合いに注意が必要です（UniTaskというライブラリがよく使われます）。

## 9-2. WebとUnityの役割分担

### Unity：体験・演出
*   3D空間の移動、アクションの手触り、豪華なエフェクト、没入感。
*   これらはHTML/CSSでは難しい、Unityの独壇場です。

### Web：情報・管理・教材
*   ログイン画面、長文のテキスト表示、一覧リスト、課金処理。
*   これらはUnityで作ると大変（文字入力などが苦手）なので、Web（HTML/React）側に任せるのが賢い設計です。
*   Reactの上にUnityのキャンバスを重ねて表示するような構成も可能です。

## 9-3. Supabase連携思想

### 認証
*   Supabase Authを使って、ユーザー登録・ログイン機能を実装できます。
*   UnityからSupabaseのAPIを叩いてトークンを取得し、それを保存します。

### 進捗・スコア同期
*   ゲームクリア時に「スコア」「クリアタイム」をSupabaseのDatabaseに送信します。
*   これにより、Web側でランキングを表示したり、学習進捗ダッシュボードを作ったりできます。
